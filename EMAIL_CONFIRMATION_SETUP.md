# تفعيل تأكيد البريد الإلكتروني في Supabase

## الخطوة 1: إعدادات المشروع في Supabase

### 1. الدخول إلى لوحة التحكم
- اذهب إلى: https://app.supabase.com
- سجل الدخول بحسابك
- اختر المشروع: **binance-watch-live**
- Project ID: `ftgvxvwvbtfkbgkuccwx`

### 2. تفعيل المصادقة بالبريد الإلكتروني

#### الخطوة أ: الدخول إلى Authentication
```
من القائمة الجانبية:
1. انقر على "Authentication" (المصادقة)
2. اختر "Providers" (مزودي الخدمات)
```

#### الخطوة ب: تفعيل البريد الإلكتروني
```
ابحث عن "Email" (البريد الإلكتروني):
1. انقر عليها
2. تأكد من وجود علامة صح (✓) بجوار "Enabled"
```

#### الخطوة ج: إعدادات تأكيد البريد
```
من قائمة Authentication:
1. انقر على "Email Templates" (نماذج البريد)
2. اختر "Confirm signup" (تأكيد التسجيل)
```

**هام:** تأكد من الإعدادات التالية:
- ✅ Enable email confirmations
- ✅ Require email confirmation to sign in
- ✅ Auto-confirm users by default: **FALSE**

### 3. إعدادات البريد الإلكتروني

#### الخيار الأول: استخدام بريد Supabase الافتراضي (للتطوير)
- Supabase يرسل رسائل تجريبية تلقائياً
- مناسب للتطوير والاختبار

#### الخيار الثاني: خادم SMTP مخصص (للإنتاج)
```
من Authentication > Email:
1. ابحث عن "SMTP Settings"
2. أدخل بيانات خادم البريد (مثل SendGrid, Gmail, AWS SES)
3. أضف بريد المرسل والمسموح له
```

## الخطوة 2: الكود في التطبيق

الكود جاهز بالفعل! عند إنشاء حساب جديد:

```typescript
const { error, data } = await supabase.auth.signUp({
  email: email.trim(),
  password,
  options: {
    emailRedirectTo: `${window.location.origin}/`,
    data: {
      full_name: fullName.trim(),
    },
  },
});
```

**ماذا يحدث:**
1. ✅ ينشئ المستخدم حساب جديد
2. ✅ يرسل رسالة تأكيد إلى البريد الإلكتروني
3. ✅ يعرض رسالة تأكيد للمستخدم
4. ✅ يطلب من المستخدم التحقق من بريده

## الخطوة 3: رسالة التأكيد

### محتوى الرسالة (يمكن تخصيصه):

```
من: noreply@supabase.io
الموضوع: تأكيد عنوان البريد الإلكتروني

---

تم إنشاء حساب جديد بهذا البريد الإلكتروني.

للتأكيد، اضغط على الرابط أدناه:
[رابط التأكيد]

إذا لم تقم بهذا الطلب، تجاهل هذه الرسالة.

---
```

## الخطوة 4: الاختبار

### اختبار محلي (Development):
```
1. افتح التطبيق على http://localhost:8080/auth
2. انقر على "إنشاء حساب جديد"
3. ادخل البريد والبيانات
4. سيظهر: "تحقق من بريدك الإلكتروني ✉️"
5. اذهب إلى لوحة تحكم Supabase > Authentication > Users
6. ستجد المستخدم الجديد مع حالة: "Email not confirmed"
```

### لإكمال الاختبار (في التطوير):
```
1. في لوحة تحكم Supabase
2. اضغط على المستخدم
3. انقر على الثلاث نقاط (...)
4. اختر "Confirm email"
5. عُد إلى التطبيق وسجل الدخول
```

## الخطوة 5: الإعدادات النهائية

### في الإنتاج (Production):
```
1. استخدم خادم SMTP حقيقي
2. أضف اسم المرسل والبريد
3. خصص نص الرسالة
4. اختبر قبل النشر
```

### في التطوير (Development):
```
- Supabase يرسل رسائل تجريبية
- تظهر في لوحة تحكم Supabase
- أو قد تصل مباشرة إذا كان البريد مسجل
```

---

## ملخص الفوائد:

✅ **الأمان**: التحقق من البريد الإلكتروني الفعلي
✅ **التأكيد**: لا يمكن الدخول إلا بعد التأكيد
✅ **الاحترافية**: واجهة مستخدم واضحة
✅ **سهل الاستخدام**: التطبيق يتولى كل شيء

---

## المشاكل الشائعة:

### المشكلة: لا تصل رسائل البريد
**الحل**:
1. تحقق من تفعيل البريد في Supabase
2. تحقق من مجلد البريد العشوائي
3. استخدم خادم SMTP مخصص
4. تحقق من صحة البريد المدخل

### المشكلة: الرسالة تصل متأخرة
**الحل**:
1. في التطوير، قد تكون فورية أو تأخر قليل
2. استخدم البريد SMTP الحقيقي
3. تحقق من إعدادات البريد

---

**حالة التطبيق**: ✅ جاهز لإرسال رسائل التأكيد
**المطلوب**: تفعيل البريد في لوحة تحكم Supabase فقط
